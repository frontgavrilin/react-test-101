{"ast":null,"code":"import * as React from \"react\";\nimport { useSyncExternalStore } from \"./useSyncExternalStore.js\";\nexport function useReactiveVar(rv) {\n  return useSyncExternalStore(React.useCallback(function (update) {\n    // By reusing the same onNext function in the nested call to\n    // rv.onNextChange(onNext), we can keep using the initial clean-up function\n    // returned by rv.onNextChange(function onNext(v){...}), without having to\n    // register the new clean-up function (returned by the nested\n    // rv.onNextChange(onNext)) with yet another callback.\n    return rv.onNextChange(function onNext() {\n      update();\n      rv.onNextChange(onNext);\n    });\n  }, [rv]), rv, rv);\n}","map":{"version":3,"sources":["../../../src/react/hooks/useReactiveVar.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,KAAZ,MAAuB,OAAvB;AAEA,SAAS,oBAAT,QAAqC,2BAArC;AAEA,OAAM,SAAU,cAAV,CAA4B,EAA5B,EAA8C;AAClD,SAAO,oBAAoB,CACzB,KAAK,CAAC,WAAN,CACE,UAAC,MAAD,EAAO;AACL;AACA;AACA;AACA;AACA;AACA,WAAO,EAAE,CAAC,YAAH,CAAgB,SAAS,MAAT,GAAe;AACpC,MAAA,MAAM;AACN,MAAA,EAAE,CAAC,YAAH,CAAgB,MAAhB;AACD,KAHM,CAAP;AAID,GAXH,EAYE,CAAC,EAAD,CAZF,CADyB,EAezB,EAfyB,EAgBzB,EAhByB,CAA3B;AAkBD","sourcesContent":["import * as React from \"react\";\nimport type { ReactiveVar } from \"../../core/index.js\";\nimport { useSyncExternalStore } from \"./useSyncExternalStore.js\";\n\nexport function useReactiveVar<T>(rv: ReactiveVar<T>): T {\n  return useSyncExternalStore(\n    React.useCallback(\n      (update) => {\n        // By reusing the same onNext function in the nested call to\n        // rv.onNextChange(onNext), we can keep using the initial clean-up function\n        // returned by rv.onNextChange(function onNext(v){...}), without having to\n        // register the new clean-up function (returned by the nested\n        // rv.onNextChange(onNext)) with yet another callback.\n        return rv.onNextChange(function onNext() {\n          update();\n          rv.onNextChange(onNext);\n        });\n      },\n      [rv]\n    ),\n    rv,\n    rv\n  );\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}